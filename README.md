# 自动化储能信息源搜索工具（以下储能领域都可替换为其他领域的，只需要把关键词和提示词进行修改）

## 项目概述

本项目是一个自动化储能信息源搜索工具，旨在帮助用户高效获取、分析和整理全球储能领域的相关信息。系统集成了搜索引擎查询、网页内容爬取、储能领域智能分析和数据格式化输出等功能，支持多语言关键词搜索和智能分类，可将搜索结果自动整理为Excel格式，便于后续分析和使用。

## 功能特点

### 核心功能
- **多搜索引擎支持**：集成Bing、Baidu、Google等主流搜索引擎（使用Google时请自配置VPN）
- **关键词智能搜索**：支持中英文混合关键词搜索，内置储能领域常用关键词库
- **搜索结果过滤**：可自定义URL过滤规则，提高结果相关性
- **网页内容自动分析**：使用Qwen大模型进行储能领域智能分析和分类
- **数据自动导出**：搜索结果自动保存为Excel格式，包含完整信息和分析结果
- **批量搜索处理**：支持多关键词批量搜索，自动控制搜索间隔避免触发反爬虫

### 智能分析功能
- **储能领域相关性判断**：自动识别内容是否属于储能领域
- **精准类别分类**：将储能相关内容分为六大类：储能技术、储能项目、储能公司、储能政策、储能市场分析、其他储能相关
- **储能公司类型细分**：将储能公司进一步细分为六类：储能设备制造商、系统集成商、项目开发商、技术提供商、项目投资商、EPC
- **公司多身份识别**：支持识别公司的多个业务身份，使用逗号分隔显示
- **置信度评分**：对分析结果提供0-1之间的置信度评分
- **判断理由说明**：提供详细的分析判断依据

## 系统架构

本项目采用模块化设计，各组件间职责清晰，便于维护和扩展：

### 主要模块
1. **main.py**：主程序入口，负责用户交互和协调各模块工作
2. **search_executor.py**：搜索引擎执行器，负责执行搜索查询并获取结果
3. **result_parser.py**：结果解析器，解析搜索结果并提取有效信息
4. **page_analyzer.py**：页面分析器，爬取网页内容并进行初步处理，包含本地缓存功能
5. **llm_connector.py**：LLM连接器，集成Qwen API进行智能内容分析，包含分析结果缓存功能
6. **output_formatter.py**：输出格式化器，将结果转换为Excel格式

### 数据流程
1. 用户输入搜索关键词和配置参数
2. 搜索执行器调用搜索引擎API获取搜索结果
3. 结果解析器提取URL和摘要信息
4. 页面分析器爬取每个URL的完整内容（优先使用缓存）
5. LLM连接器对内容进行储能领域智能分析（优先使用缓存）
6. 输出格式化器整合所有信息并生成Excel文件

## 安装与配置

### 环境要求
- Python 3.6+
- 依赖库：详见requirements.txt

### 安装步骤
1. 克隆或下载项目代码到本地
2. 安装所需依赖：
```bash
pip install -r requirements.txt
```

### 配置说明
1. **API密钥配置**：在`llm_connector.py`中已配置Qwen API密钥（默认使用内置密钥）
2. **默认关键词**：可在`main.py`中修改默认搜索关键词列表
3. **URL过滤词**：可自定义URL过滤规则，默认过滤新闻、社交媒体、研究报告等非核心内容网站
4. **缓存配置**：在`main.py`中初始化PageAnalyzer和LLMConnector时可配置缓存行为

## 使用方法

### 基本使用流程
1. 运行主程序：
```bash
python main.py
```

2. 按照提示完成以下配置：
   - 是否使用默认关键词（默认：是）
   - 搜索时间间隔（默认：2秒）
   - 选择搜索引擎（默认：Bing）
   - 搜索页数（默认：1页，最大：10页）
   - 是否使用默认URL过滤词（默认：是）
   - 是否进行页面分析（默认：是）
   - 是否进行储能领域分类（默认：是）

3. 程序将自动执行搜索、爬取和分析，完成后生成Excel文件保存到当前目录

### 示例场景

#### 场景一：搜索储能EPC企业信息
1. 使用默认关键词中的储能EPC相关词汇
2. 设置搜索页数为3页以获取更多结果
3. 开启页面分析和储能领域分类
4. 程序将返回全球储能EPC企业相关信息，并自动分类为储能公司-EPC类型
5. 对于同时提供系统集成服务的公司，将显示为"储能公司-系统集成商,储能公司-EPC"

#### 场景二：搜索储能技术创新信息
1. 自定义关键词，如："液流电池技术创新,钠离子电池进展,新型储能材料"
2. 增加搜索时间间隔至5秒，避免触发反爬虫
3. 选择Google搜索引擎获取更全面的技术信息
4. 分析结果将主要归类为储能技术类别

## Qwen API集成说明

### API配置
- **模型名称**：qwen-long
- **API端点**：https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation
- **API密钥**：已内置配置

### 智能分析能力
系统通过精心设计的提示词工程，实现以下分析能力：

1. **储能领域识别**：基于丰富的关键词匹配和内容主题判断，包括电池储能、抽水蓄能、压缩空气储能、飞轮储能、氢储能、电化学储能、热能储存等多种储能形式
2. **多级分类系统**：六大储能类别精确分类
3. **储能公司类型细分**：六大公司类型识别与多身份支持
4. **置信度评分**：0-1之间的量化评分，反映判断可靠性
5. **详细分析理由**：提供具体的判断依据和推理过程

### 分析输出格式
```json
{
  "is_energy_storage": true,          // 是否属于储能领域
  "category": "储能公司",           // 具体类别
  "company_type": "储能公司-系统集成商,储能公司-EPC", // 公司类型（支持多选）
  "confidence": 0.95,                // 置信度评分
  "reason": "内容明确提及储能EPC业务和系统集成服务，包含企业名称和业务描述"  // 判断理由
}
```

## 输出文件说明

生成的Excel文件包含以下信息：
- 搜索关键词
- 序号
- 标题
- 部分内容
- 链接地址
- 跳转链接
- 是否储能领域
- 储能类别
- 公司类型
- 置信度
- 分析理由
- 页面标题
- 页面字数
- 页面分析状态
- LLM分析状态

文件名格式：`数据源YYYYMMDDHHMMSS.xlsx`（基于当前时间生成）

## 高级功能

### URL过滤功能
系统默认过滤以下类型网站，提高搜索结果质量：
- 社交媒体平台（如知乎、LinkedIn）
- 新闻网站
- 研究报告和分析网站
- 技术文档网站
- 金融和法律相关网站

用户可在`main.py`中的`default_filter_words`变量自定义过滤规则。


## 注意事项

1. **API调用限制**：Qwen API有调用频率限制，建议合理设置搜索间隔
2. **反爬虫措施**：系统已实现翻页时1-3秒随机等待时间，有效降低被识别为爬虫的风险。如遇到爬取失败，可进一步增加搜索间隔
3. **内容分析准确性**：智能分析依赖于网页内容质量，对于内容较少或格式不规范的页面，准确性可能降低
4. **中文编码**：确保系统环境支持UTF-8编码，避免中文显示问题
5. **缓存管理**：缓存会随时间积累占用磁盘空间，定期清理可能有助于保持系统性能

## 故障排除

1. **搜索失败**：检查网络连接和搜索引擎可用性，尝试增加搜索间隔
2. **API调用失败**：验证API密钥是否有效，检查网络连接
3. **Excel生成失败**：确认openpyxl库已正确安装，检查磁盘空间
4. **编码错误**：在代码中添加适当的编码声明（如`# -*- coding: utf-8 -*-`）
5. **缓存问题**：如需重新分析相同URL，可删除相应缓存文件或临时禁用缓存功能

## 更新日志

- **初始版本**：基础搜索、爬取和分析功能
- **v1.0**：集成Qwen API智能分析，优化提示词工程
- **v1.1**：默认启用页面分析和储能分类功能
- **v1.2**：优化系统提示词，提高分析准确性和一致性
- **v1.3**：优化翻页机制，实现1-3秒随机等待时间，有效避免触发反爬机制
- **v1.4**：增加网址url去重机制，避免大模型处理重复相同页面
- **v1.5**：实现储能公司类型细分，支持六类公司身份识别
- **v1.6**：支持公司多身份识别，可同时识别多个业务类型
- **v1.7**：增强关键词库和URL过滤功能，提高搜索结果质量

## 许可证

本项目仅供内部使用，未经授权不得用于商业目的。

## 联系方式

如有问题或建议，请联系项目维护团队。
